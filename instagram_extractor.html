<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagramç”¨æˆ·åæå–å™¨</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            padding: 40px 20px;
            max-width: 900px;
            margin: auto;
            background: #ffffff;
            min-height: 100vh;
            position: relative;
        }
        
        .container {
            position: relative;
            z-index: 1;
        }
        
        .ad-left, .ad-right {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            width: 200px;
            height: 400px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            color: #4facfe;
            z-index: 10;
            animation: fadeIn 0.8s ease-out;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .ad-left {
            left: 20px;
        }
        
        .ad-right {
            right: 20px;
        }
        
        .ad-left:hover, .ad-right:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
        }
        
        @media (max-width: 1400px) {
            .ad-left, .ad-right {
                display: none;
            }
        }
        
        h1 {
            color: #333;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            text-align: center;
            animation: fadeInDown 0.6s ease-out;
        }
        
        h2 {
            color: #333;
            font-size: 1.8em;
            font-weight: 600;
            margin: 40px 0 15px 0;
            text-align: center;
            animation: fadeInDown 0.6s ease-out 0.1s both;
        }
        
        p {
            color: #666;
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 20px;
            text-align: center;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }
        
        .review-label {
            color: #ffd700;
            font-weight: 700;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            font-size: 16px;
            padding: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: #333;
            font-family: inherit;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            resize: vertical;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }
        
        textarea:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }
        
        textarea::placeholder {
            color: #999;
        }
        
        button {
            padding: 14px 32px;
            font-size: 16px;
            font-weight: 600;
            margin: 15px 10px 0 0;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
            position: relative;
            overflow: hidden;
            animation: fadeInUpButton 0.6s ease-out 0.4s forwards;
            transform: scale(1);
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        button:hover {
            transform: scale(1.05) !important;
            box-shadow: 0 12px 40px rgba(79, 172, 254, 0.5);
        }
        
        button:active {
            transform: scale(0.98);
            box-shadow: 0 2px 10px rgba(79, 172, 254, 0.3);
        }
        
        button:active::before {
            width: 300px;
            height: 300px;
        }
        
        .output-wrapper {
            margin-top: 25px;
            animation: fadeInUp 0.6s ease-out 0.5s both;
        }
        
        #output, #output2, #output3 {
            padding: 25px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 16px;
            white-space: pre-wrap;
            word-break: break-all;
            min-height: 100px;
            color: #333;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            animation: slideIn 0.5s ease-out;
        }
        
        #output:empty, #output2:empty, #output3:empty {
            color: #999;
        }
        
        .stats {
            margin-top: 15px;
            font-size: 14px;
            color: #666;
            padding: 10px 0;
            animation: fadeIn 0.5s ease-out 0.6s both;
        }
        
        #dropZone {
            margin-bottom: 15px;
            padding: 30px;
            border: 2px dashed rgba(79, 172, 254, 0.3);
            border-radius: 20px;
            background: rgba(79, 172, 254, 0.05);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            animation: fadeInUp 0.6s ease-out 0.35s both;
        }
        
        #dropZone:hover {
            border-color: rgba(79, 172, 254, 0.5);
            background: rgba(79, 172, 254, 0.08);
        }
        
        #dropZone .drop-text {
            color: #4facfe;
            font-size: 16px;
            font-weight: 600;
        }
        
        #dropZone .drop-hint {
            color: #999;
            font-size: 12px;
            margin-top: 5px;
        }
        
        .stats-title {
            display: inline;
            font-weight: 600;
        }
        
        .duplicate-item {
            color: #ff6b6b;
            display: inline;
            margin-left: 10px;
            font-weight: 600;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUpButton {
            from {
                opacity: 0;
                transform: translateY(20px) scale(1);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            h2 {
                font-size: 1.5em;
            }
            
            button {
                width: 100%;
                margin: 10px 0 0 0;
            }
        }
    </style>
</head>
<body>
    <!-- å·¦ä¾§å¹¿å‘Šä½ -->
    <div class="ad-left">å¹¿å‘Šä½æ‹›ç§Ÿ</div>
    
    <!-- å³ä¾§å¹¿å‘Šä½ -->
    <div class="ad-right">å¹¿å‘Šä½æ‹›ç§Ÿ</div>
    
    <div class="container">
    <h1>Instagramç”¨æˆ·åæå–å™¨</h1>
    <p><span class="review-label">æœ€è¿‘è¯„ä»·ï¼š</span>æˆ‘è‰¹ï¼Œè¿™ä¸ªç½‘ç«™å·¨ä»–å¦ˆå¥½ç”¨ã€‚</p>
    
    <textarea id="input" placeholder="æ”¯æŒä¸¤ç§æ ¼å¼ï¼š&#10;1. é“¾æ¥æ ¼å¼ï¼š&lt;https://www.instagram.com/maryhvp19&gt;&#10;2. æ¨¡æ¿æ ¼å¼ï¼šå°ç£è‡ªé¸Cï¼š&#10;   dailylife_recording&#10;   chime_bento"></textarea><br>
    <button onclick="extract()">æå–ç”¨æˆ·å</button>
    <button onclick="copyResult()">å¤åˆ¶ç»“æœ</button>
    
    <div class="output-wrapper">
    <div id="output">ç»“æœæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        <div id="stats1" class="stats"></div>
    </div>

    <!-- åŠŸèƒ½1ï¼šæ ¼å¼è½¬æ¢å™¨ -->
    <h2>æ ¼å¼è½¬æ¢å™¨</h2>
    <p>æ”¯æŒä¸¤ç§æ ¼å¼ï¼š1. ID----ç”¨æˆ·å----å¯†ç ...æ ¼å¼ æˆ– 2. Excelå¤åˆ¶ç²˜è´´çš„å¤šè¡Œæ ¼å¼ï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰</p>
    
    <!-- æ–‡ä»¶æ‹–æ‹½åŒºåŸŸ -->
    <div id="dropZone">
        <div class="drop-text">ğŸ“ æ‹–æ‹½ TXT æˆ– Excel æ–‡ä»¶åˆ°è¿™é‡Œå¯¼å…¥</div>
        <div class="drop-hint">æ”¯æŒ .txt å’Œ .xlsx æ–‡ä»¶</div>
    </div>
    
    <textarea id="input2" placeholder="ç²˜è´´æ•°æ®ï¼ˆæ”¯æŒä¸¤ç§æ ¼å¼ï¼Œè‡ªåŠ¨è¯†åˆ«ï¼‰...&#10;æ ¼å¼1ï¼š37354 wusiufan----N31DG65i----xlje.3680188988@gosoftme.com----xlje.3680188988----OVVZOH7RJDAS7JO2ZJAOJW735T4XWB4X----[JSONæ•°æ®]----é¦™æ¸¯&#10;æ ¼å¼2ï¼šä»Excelå¤åˆ¶ç²˜è´´çš„å¤šè¡Œæ•°æ®"></textarea><br>
    <button onclick="convertFormat()">è½¬æ¢æ ¼å¼</button>
    <button onclick="copyResult2()">å¤åˆ¶è½¬æ¢ç»“æœ</button>
    <div class="output-wrapper">
    <div id="output2">è½¬æ¢ç»“æœæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        <div id="stats2" class="stats"></div>
    </div>

    <!-- åŠŸèƒ½2ï¼šTabè½¬åˆ†éš”ç¬¦è½¬æ¢å™¨ -->
    <h2>Tabè½¬åˆ†éš”ç¬¦è½¬æ¢å™¨</h2>
    <p>å°†åˆ¶è¡¨ç¬¦(Tab)åˆ†éš”çš„æ•°æ®è½¬æ¢ä¸º----åˆ†éš”æ ¼å¼</p>
    <textarea id="input3" placeholder="ç²˜è´´Tabåˆ†éš”çš„æ•°æ®...&#10;ä¾‹ï¼š&#10;peterober666	VT0b8AjWXBfv	Q3HL D5YD Q3Z6 ZHZL O5UL 3CML 4WO3 7VYO	petrob85@gmx.com	q4J8ox42Ng	https://gmx.com/	https://2fa.plus/	us"></textarea><br>
    <button onclick="convertTabToSeparator()">Tabè½¬----</button>
    <button onclick="copyResult3()">å¤åˆ¶ç»“æœ</button>
    <div class="output-wrapper">
    <div id="output3">è½¬æ¢ç»“æœæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
    </div>
    </div>

    <script>
        // æ·»åŠ è¾“å‡ºæ¡†æ›´æ–°åŠ¨ç”»çš„è¾…åŠ©å‡½æ•°
        function animateOutput(elementId) {
            const element = document.getElementById(elementId);
            element.style.opacity = '0';
            element.style.transform = 'translateY(10px)';
            setTimeout(() => {
                element.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                element.style.opacity = '1';
                element.style.transform = 'translateY(0)';
            }, 10);
        }
        
        // åŠŸèƒ½1ï¼šæå–Instagramç”¨æˆ·å
        function extract() {
            let input = document.getElementById('input').value.trim();
            if (!input) {
                document.getElementById('output').innerText = 'è¯·è¾“å…¥å†…å®¹';
                document.getElementById('stats1').innerHTML = '';
                return;
            }
            
            let usernames = [];
            
            // æ£€æµ‹æ˜¯å¦åŒ…å« instagram.com é“¾æ¥
            let hasInstagramLink = /instagram\.com/i.test(input);
            
            if (hasInstagramLink) {
                // é“¾æ¥æ ¼å¼ï¼šä½¿ç”¨åŸæœ‰é€»è¾‘
                let regex = /(?:https?:\/\/)?(?:www\.)?instagram\.com\/([a-zA-Z0-9._]+)/gi;
                let matches = input.matchAll(regex);
                for (let match of matches) {
                    usernames.push(match[1]);
                }
            } else {
                // æ¨¡æ¿æ ¼å¼ï¼šæå–æ‰€æœ‰ç”¨æˆ·åï¼ˆè·³è¿‡åŒ…å«ä¸­æ–‡çš„è¡Œï¼‰
                let lines = input.split('\n');
                lines.forEach(line => {
                    let trimmed = line.trim();
                    // è·³è¿‡ç©ºè¡Œ
                    if (!trimmed) return;
                    
                    // æ£€æµ‹æ˜¯å¦åŒ…å«ä¸­æ–‡å­—ç¬¦
                    let hasChinese = /[\u4e00-\u9fa5]/.test(trimmed);
                    
                    if (hasChinese) {
                        // å¦‚æœåŒ…å«ä¸­æ–‡ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å†’å·ï¼ˆï¼šæˆ–:ï¼‰ï¼Œå¦‚æœæœ‰åˆ™æå–å†’å·åé¢çš„ç”¨æˆ·å
                        let colonIndex = trimmed.search(/[ï¼š:]/);
                        if (colonIndex !== -1) {
                            // æå–å†’å·åé¢çš„éƒ¨åˆ†
                            let afterColon = trimmed.substring(colonIndex + 1).trim();
                            // å¦‚æœå†’å·åé¢æœ‰å†…å®¹ï¼Œå°è¯•æå–ç”¨æˆ·å
                            if (afterColon) {
                                // å¯èƒ½å†’å·åé¢æœ‰å¤šä¸ªç”¨æˆ·åï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼‰ï¼Œæå–ç¬¬ä¸€ä¸ª
                                let firstPart = afterColon.split(/\s+/)[0].trim();
                                if (firstPart && firstPart.match(/^[a-zA-Z0-9._]+$/)) {
                                    usernames.push(firstPart);
                                }
                            }
                        }
                        // åŒ…å«ä¸­æ–‡çš„è¡Œè·³è¿‡ï¼ˆé™¤éä¸Šé¢å·²ç»æå–äº†ç”¨æˆ·åï¼‰
                        return;
                    }
                    
                    // ä¸åŒ…å«ä¸­æ–‡çš„è¡Œï¼Œæå–ç”¨æˆ·å
                    // å¯èƒ½ä¸€è¡Œæœ‰å¤šä¸ªç”¨æˆ·åï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼‰
                    let parts = trimmed.split(/\s+/);
                    parts.forEach(part => {
                        let username = part.trim();
                        // éªŒè¯ç”¨æˆ·åæ ¼å¼ï¼ˆåªåŒ…å«å­—æ¯ã€æ•°å­—ã€ç‚¹ã€ä¸‹åˆ’çº¿ï¼‰
                        if (username && username.match(/^[a-zA-Z0-9._]+$/)) {
                            usernames.push(username);
                        }
                    });
                });
            }
            
            if (usernames.length === 0) {
                document.getElementById('output').innerText = 'æœªæ‰¾åˆ°Instagramç”¨æˆ·å\nè¯·æ£€æŸ¥æ˜¯å¦åŒ…å« instagram.com/ç”¨æˆ·å æ ¼å¼æˆ–æ¨¡æ¿æ ¼å¼';
                document.getElementById('stats1').innerHTML = '';
                return;
            }
            
            // ç»Ÿè®¡é‡å¤
            let countMap = {};
            usernames.forEach(username => {
                countMap[username] = (countMap[username] || 0) + 1;
            });
            
            // å»é‡ï¼Œä¿æŒç¬¬ä¸€æ¬¡å‡ºç°çš„é¡ºåº
            let uniqueUsernames = [];
            let seen = new Set();
            for (let username of usernames) {
                if (!seen.has(username)) {
                    seen.add(username);
                    uniqueUsernames.push(username);
                }
            }
            
            let duplicates = [];
            for (let username in countMap) {
                if (countMap[username] > 1) {
                    duplicates.push({username: username, count: countMap[username]});
                }
            }
            
            // æ˜¾ç¤ºç»“æœï¼ˆå»é‡åçš„ï¼‰
            let result = uniqueUsernames.join('*');
            document.getElementById('output').innerText = result;
            animateOutput('output');
            
            // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆæ˜¾ç¤ºå»é‡åçš„æ•°é‡ï¼‰
            let statsHtml = '<span class="stats-title">æ•°é‡: ' + uniqueUsernames.length + '</span>';
            if (duplicates.length > 0) {
                statsHtml += '<span>ï¼Œé‡å¤:';
                duplicates.forEach((dup, index) => {
                    if (index > 0) statsHtml += 'ï¼Œ';
                    statsHtml += '<span class="duplicate-item">' + dup.username + ': ' + dup.count + 'æ¬¡</span>';
                });
                statsHtml += '</span>';
            }
            document.getElementById('stats1').innerHTML = statsHtml;
        }
        
        function copyResult() {
            let text = document.getElementById('output').innerText.trim();
            if (!text || text === 'è¯·è¾“å…¥å†…å®¹' || text.includes('æœªæ‰¾åˆ°')) {
                return;
            }
            
            let temp = document.createElement('textarea');
            temp.value = text;
            temp.style.position = 'fixed';
            temp.style.opacity = '0';
            document.body.appendChild(temp);
            temp.select();
            
            try {
                document.execCommand('copy');
            } catch (err) {
                // é™é»˜å¤±è´¥
            }
            
            document.body.removeChild(temp);
        }
        
        // åŠŸèƒ½2ï¼šæ ¼å¼è½¬æ¢å™¨
        function convertFormat() {
            let input = document.getElementById('input2').value.trim();
            if (!input) {
                document.getElementById('output2').innerText = 'è¯·è¾“å…¥å†…å®¹';
                document.getElementById('stats2').innerHTML = '';
                return;
            }
            
            // æ£€æµ‹æ ¼å¼ç±»å‹ï¼šå¦‚æœåŒ…å«----åˆ†éš”ç¬¦ï¼Œä½¿ç”¨æ—§æ ¼å¼ï¼›å¦åˆ™ä½¿ç”¨æ–°æ ¼å¼ï¼ˆExcelå¤åˆ¶ç²˜è´´ï¼‰
            let isOldFormat = input.includes('----');
            
            if (isOldFormat) {
                convertOldFormat(input);
            } else {
                convertExcelFormat(input);
            }
        }
        
        // æ—§æ ¼å¼è½¬æ¢ï¼ˆåŸæœ‰çš„----åˆ†éš”æ ¼å¼ï¼‰
        function convertOldFormat(input) {
            let lines = input.split('\n');
            let results = [];
            
            lines.forEach(line => {
                if (line.trim() === '') return;
                
                // å¤„ç†æ¯è¡Œæ•°æ®
                let firstPartEnd = line.indexOf('----');
                if (firstPartEnd === -1) return;
                
                let firstPart = line.substring(0, firstPartEnd);
                let rest = line.substring(firstPartEnd + 4);
                
                // ä»firstPartä¸­æå–ç”¨æˆ·å
                let username = '';
                let lastSpaceIndex = firstPart.lastIndexOf(' ');
                if (lastSpaceIndex !== -1) {
                    username = firstPart.substring(lastSpaceIndex + 1);
                } else {
                    username = firstPart;
                }
                
                // åˆ†å‰²å‰©ä½™éƒ¨åˆ†
                let restParts = rest.split('----');
                
                // æå–å„éƒ¨åˆ†
                let password = restParts[0] || '';
                let email = restParts[1] || '';
                let userId = restParts[2] || '';
                let twofa = restParts[3] || '';  // 2FAåœ¨ç¬¬4ä¸ªä½ç½®ï¼ˆç´¢å¼•3ï¼‰
                let country = '';
                
                // å¦‚æœrestPartsæœ‰6ä¸ªæˆ–æ›´å¤šå…ƒç´ ï¼Œæœ€åä¸€ä¸ªæ˜¯å›½å®¶
                if (restParts.length >= 6) {
                    country = restParts[restParts.length - 1];
                }
                
                // æ„å»ºæ–°æ ¼å¼ï¼ˆé¡ºåºï¼šç”¨æˆ·åã€å¯†ç ã€2FAã€é‚®ç®±ã€ç”¨æˆ·IDã€å›½å®¶ã€URL1ã€URL2ï¼‰
                let newFormat = [
                    username,                      // ç”¨æˆ·å
                    password,                      // å¯†ç 
                    twofa,                         // 2FA
                    email,                         // é‚®ç®±
                    userId,                        // ç”¨æˆ·ID
                    country,                       // å›½å®¶
                    'https://mail.gosoftme.com/',  // æ–°å¢çš„å›ºå®šURL
                    'https://2fa.plus/'            // å›ºå®šURL
                ].join('----');
                
                results.push(newFormat);
            });
            
            if (results.length === 0) {
                document.getElementById('output2').innerText = 'æ ¼å¼ä¸æ­£ç¡®æˆ–æ²¡æœ‰æœ‰æ•ˆæ•°æ®';
                document.getElementById('stats2').innerHTML = '';
                return;
            }
            
            // æ¯è¡Œä¹‹é—´ç©ºä¸€è¡Œï¼ˆä¸¤ä¸ªæ¢è¡Œç¬¦ï¼‰ï¼Œæœ€åç©ºä¸€è¡Œå¹¶æ˜¾ç¤ºæ•°é‡
            let outputText = results.join('\n\n') + '\n\næ•°é‡ï¼š' + results.length + 'ä¸ª';
            document.getElementById('output2').innerText = outputText;
            animateOutput('output2');
            
            // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆæ ¼å¼ä¸stats1ä¸€è‡´ï¼‰
            let statsHtml = '<span class="stats-title">æ•°é‡: ' + results.length + 'ä¸ª</span>';
            document.getElementById('stats2').innerHTML = statsHtml;
        }
        
        // æ–°æ ¼å¼è½¬æ¢ï¼ˆExcelå¤åˆ¶ç²˜è´´æ ¼å¼ï¼Œæ”¯æŒTabåˆ†éš”å’Œæ¢è¡Œåˆ†éš”ï¼‰
        function convertExcelFormat(input) {
            let results = [];
            
            // æ£€æµ‹æ ¼å¼ï¼š
            // 1. å¦‚æœç¬¬ä¸€è¡ŒåŒ…å«Tabä¸”åˆ—æ•°å¾ˆå¤šï¼ˆ>5åˆ—ï¼‰ï¼Œè¯´æ˜æ˜¯ç”µè„‘æ ¼å¼ï¼ˆå•è¡Œä¸€æ¡è®°å½•ï¼‰
            // 2. å¦‚æœåŒ…å«Tabä½†åˆ—æ•°è¾ƒå°‘ï¼Œæˆ–è€…æŒ‰åºå·åˆ†å‰²ï¼Œè¯´æ˜æ˜¯æ‰‹æœºæ ¼å¼ï¼ˆå¤šè¡Œä¸€æ¡è®°å½•ï¼‰
            let firstLine = input.split('\n')[0].trim();
            let hasTab = firstLine.includes('\t');
            let isTabFormat = false;
            
            if (hasTab) {
                let columns = firstLine.split('\t').filter(c => c.trim());
                // å¦‚æœç¬¬ä¸€è¡Œåˆ—æ•°å¾ˆå¤šï¼ˆ>5åˆ—ï¼‰ï¼Œè¯´æ˜æ˜¯ç”µè„‘æ ¼å¼
                if (columns.length > 5) {
                    isTabFormat = true;
                }
            }
            
            if (isTabFormat) {
                // ç”µè„‘æ ¼å¼ï¼šTabåˆ†éš”çš„å•è¡Œæ•°æ®
                let lines = input.split('\n').filter(l => l.trim());
                
                lines.forEach(line => {
                    // æŒ‰Tabåˆ†å‰²åˆ—
                    let columns = line.split('\t').map(c => c.trim());
                    
                    if (columns.length < 3) return;
                    
                    let username = columns[1] || '';
                    let password = columns[2] || '';
                    let twofa = columns[3] || '';
                    let email = '';
                    let userId = '';
                    
                    // æŸ¥æ‰¾é‚®ç®±ï¼ˆåŒ…å«@ç¬¦å·çš„åˆ—ï¼‰
                    for (let i = 4; i < columns.length; i++) {
                        if (columns[i] && columns[i].includes('@')) {
                            email = columns[i];
                            // ç”¨æˆ·IDé€šå¸¸åœ¨é‚®ç®±çš„ä¸‹ä¸€åˆ—
                            if (i + 1 < columns.length && columns[i + 1] && !columns[i + 1].includes('@') && !columns[i + 1].includes('[')) {
                                userId = columns[i + 1];
                            }
                            break;
                        }
                    }
                    
                    // å¦‚æœæ²¡æ‰¾åˆ°é‚®ç®±ï¼Œå°è¯•ä»åˆ—8å¼€å§‹æŸ¥æ‰¾
                    if (!email && columns.length > 8) {
                        email = columns[8] || '';
                        userId = columns[9] || '';
                    }
                    
                    // æŸ¥æ‰¾ç”¨æˆ·IDï¼ˆå¦‚æœè¿˜æ²¡æ‰¾åˆ°ï¼ŒæŸ¥æ‰¾åŒ…å«insçš„åˆ—ï¼‰
                    if (!userId) {
                        for (let i = 0; i < columns.length; i++) {
                            if (columns[i] && columns[i].includes('ins') && !columns[i].includes('@') && !columns[i].includes('[')) {
                                userId = columns[i];
                                break;
                            }
                        }
                    }
                    
                    // æ„å»ºè¾“å‡ºæ ¼å¼
                    let newFormat = [
                        username,
                        password,
                        twofa,
                        email,
                        userId,
                        'https://mail.hebmails.com/',
                        'https://2fa.plus/'
                    ].join('----');
                    
                    if (username) {
                        results.push(newFormat);
                    }
                });
            } else {
                // æ‰‹æœºæ ¼å¼ï¼šæ¢è¡Œåˆ†éš”çš„å¤šè¡Œæ•°æ®ï¼ŒæŒ‰åºå·ï¼ˆæ•°å­—å¼€å¤´ï¼‰åˆ†å‰²è®°å½•
                // å…ˆæŒ‰ç©ºè¡Œå°è¯•åˆ†å‰²ï¼Œå¦‚æœåˆ†å‰²ååªæœ‰1ä¸ªè®°å½•ï¼Œåˆ™æŒ‰åºå·åˆ†å‰²
                let records = input.split(/\n\s*\n/).filter(r => r.trim());
                
                // å¦‚æœæŒ‰ç©ºè¡Œåˆ†å‰²åªæœ‰1ä¸ªè®°å½•ï¼Œè¯´æ˜è®°å½•ä¹‹é—´æ²¡æœ‰ç©ºè¡Œï¼Œéœ€è¦æŒ‰åºå·åˆ†å‰²
                if (records.length === 1) {
                    // æŒ‰åºå·ï¼ˆæ•°å­—+Tab+éæ•°å­—å†…å®¹ï¼‰åˆ†å‰²è®°å½•
                    let allLines = input.split('\n');
                    records = [];
                    let currentRecord = [];
                    
                    for (let i = 0; i < allLines.length; i++) {
                        let line = allLines[i];
                        let trimmed = line.trim();
                        
                        // åˆ¤æ–­æ˜¯å¦æ˜¯åºå·è¡Œï¼šæ•°å­—+Tabï¼Œåé¢è·Ÿéæ•°å­—å†…å®¹ï¼ˆå¦‚ç”¨æˆ·åï¼‰
                        // æ’é™¤æ•°å­—è¡Œï¼ˆå¦‚ï¼š0	0	0	ï¼‰
                        let isSequenceLine = false;
                        if (trimmed.match(/^\d+\t/)) {
                            let parts = trimmed.split('\t').filter(p => p.trim());
                            // å¦‚æœç¬¬äºŒéƒ¨åˆ†ä¸æ˜¯çº¯æ•°å­—ï¼Œè¯´æ˜æ˜¯åºå·è¡Œï¼ˆå¦‚ï¼š1	ç”¨æˆ·åï¼‰
                            if (parts.length > 1 && !parts[1].match(/^\d+$/)) {
                                isSequenceLine = true;
                            }
                        }
                        
                        // å¦‚æœæ˜¯åºå·è¡Œï¼Œä¸”å½“å‰è®°å½•ä¸ä¸ºç©ºï¼Œåˆ™å¼€å§‹æ–°è®°å½•
                        if (isSequenceLine && currentRecord.length > 0) {
                            records.push(currentRecord.join('\n'));
                            currentRecord = [line];
                        } else {
                            currentRecord.push(line);
                        }
                    }
                    // æ·»åŠ æœ€åä¸€ä¸ªè®°å½•
                    if (currentRecord.length > 0) {
                        records.push(currentRecord.join('\n'));
                    }
                    
                    // è¿‡æ»¤æ‰ç©ºè®°å½•
                    records = records.filter(r => r.trim());
                }
                
                records.forEach(record => {
                    let rawLines = record.split('\n');
                    let lines = [];
                    let username = '';
                    let password = '';
                    let twofa = '';
                    let email = '';
                    let userId = '';
                    
                    // å¤„ç†ç¬¬ä¸€è¡Œï¼šåŒ…å«åºå·ã€ç”¨æˆ·åã€å¯†ç ï¼ˆTabåˆ†éš”ï¼‰
                    if (rawLines.length > 0) {
                        let firstLine = rawLines[0].trim();
                        if (firstLine.includes('\t')) {
                            let cols = firstLine.split('\t').map(c => c.trim()).filter(c => c);
                            // ç¬¬0åˆ—ï¼šåºå·ï¼ˆå¿½ç•¥ï¼‰
                            // ç¬¬1åˆ—ï¼šç”¨æˆ·å
                            // ç¬¬2åˆ—ï¼šå¯†ç 
                            if (cols.length > 1) username = cols[1] || '';
                            if (cols.length > 2) password = cols[2] || '';
                        }
                    }
                    
                    // å¤„ç†åç»­è¡Œï¼Œç›´æ¥ä»åŸå§‹è¡Œä¸­æå–
                    for (let i = 1; i < rawLines.length; i++) {
                        let line = rawLines[i].trim();
                        if (!line) continue;
                        
                        // è·³è¿‡æ•°å­—è¡Œï¼ˆå¦‚ï¼š0	0	0	ï¼‰
                        if (line.match(/^\d+\t\d+\t\d+/)) {
                            continue;
                        }
                        
                        // å¦‚æœåŒ…å«Tabï¼Œåªå–ç¬¬ä¸€åˆ—ï¼ˆå»é™¤Tabåˆ†éš”çš„å¤šåˆ—ï¼‰
                        if (line.includes('\t')) {
                            let firstCol = line.split('\t')[0].trim();
                            if (firstCol && !firstCol.match(/^\d+$/)) { // å¿½ç•¥çº¯æ•°å­—
                                lines.push(firstCol);
                            }
                        } else {
                            lines.push(line);
                        }
                    }
                    
                    // æå–2FAï¼ˆé€šå¸¸æ˜¯ç¬¬ä¸€ä¸ªéç©ºè¡Œï¼Œä¸”ä¸åŒ…å«@å’Œ[ï¼Œé•¿åº¦è¾ƒé•¿ï¼‰
                    for (let i = 0; i < lines.length; i++) {
                        if (lines[i] && 
                            !lines[i].includes('@') && 
                            !lines[i].includes('[') && 
                            !lines[i].includes('{') &&
                            !lines[i].includes('ins') &&
                            lines[i].length > 10) { // 2FAé€šå¸¸è¾ƒé•¿
                            twofa = lines[i];
                            break;
                        }
                    }
                    
                    // æŸ¥æ‰¾é‚®ç®±ï¼ˆåŒ…å«@ç¬¦å·çš„è¡Œï¼‰
                    for (let i = 0; i < lines.length; i++) {
                        if (lines[i] && lines[i].includes('@')) {
                            email = lines[i];
                            // ç”¨æˆ·IDé€šå¸¸åœ¨é‚®ç®±çš„ä¸‹ä¸€è¡Œ
                            if (i + 1 < lines.length && lines[i + 1] && !lines[i + 1].includes('@') && !lines[i + 1].includes('[') && !lines[i + 1].includes('{')) {
                                userId = lines[i + 1];
                            }
                            break;
                        }
                    }
                    
                    // æŸ¥æ‰¾ç”¨æˆ·IDï¼ˆå¦‚æœè¿˜æ²¡æ‰¾åˆ°ï¼ŒæŸ¥æ‰¾åŒ…å«insä½†ä¸åŒ…å«@çš„è¡Œï¼‰
                    if (!userId) {
                        for (let i = 0; i < lines.length; i++) {
                            if (lines[i] && lines[i].includes('ins') && !lines[i].includes('@') && !lines[i].includes('[') && !lines[i].includes('{')) {
                                userId = lines[i];
                                break;
                            }
                        }
                    }
                    
                    // æ„å»ºè¾“å‡ºæ ¼å¼
                    let newFormat = [
                        username,
                        password,
                        twofa,
                        email,
                        userId,
                        'https://mail.hebmails.com/',
                        'https://2fa.plus/'
                    ].join('----');
                    
                    if (username) {
                        results.push(newFormat);
                    }
                });
            }
            
            if (results.length === 0) {
                document.getElementById('output2').innerText = 'æ ¼å¼ä¸æ­£ç¡®æˆ–æ²¡æœ‰æœ‰æ•ˆæ•°æ®';
                document.getElementById('stats2').innerHTML = '';
                return;
            }
            
            // æ¯è¡Œä¹‹é—´ç©ºä¸€è¡Œï¼ˆä¸¤ä¸ªæ¢è¡Œç¬¦ï¼‰ï¼Œæœ€åç©ºä¸€è¡Œå¹¶æ˜¾ç¤ºæ•°é‡
            let outputText = results.join('\n\n') + '\n\næ•°é‡ï¼š' + results.length + 'ä¸ª';
            document.getElementById('output2').innerText = outputText;
            animateOutput('output2');
            
            // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
            let statsHtml = '<span class="stats-title">æ•°é‡: ' + results.length + 'ä¸ª</span>';
            document.getElementById('stats2').innerHTML = statsHtml;
        }

        function copyResult2() {
            let text = document.getElementById('output2').innerText.trim();
            if (!text || text === 'è¯·è¾“å…¥å†…å®¹' || text.includes('æ ¼å¼ä¸æ­£ç¡®')) {
                return;
            }
            
            let temp = document.createElement('textarea');
            temp.value = text;
            temp.style.position = 'fixed';
            temp.style.opacity = '0';
            document.body.appendChild(temp);
            temp.select();
            
            try {
                document.execCommand('copy');
            } catch (err) {
                // é™é»˜å¤±è´¥
            }
            
            document.body.removeChild(temp);
        }
        
        // åŠŸèƒ½3ï¼šTabè½¬åˆ†éš”ç¬¦è½¬æ¢å™¨
        function convertTabToSeparator() {
            let input = document.getElementById('input3').value.trim();
            if (!input) {
                document.getElementById('output3').innerText = 'è¯·è¾“å…¥å†…å®¹';
                return;
            }
            
            let lines = input.split('\n');
            let results = [];
            
            lines.forEach(line => {
                if (line.trim() === '') return;
                // å°†Tabæ›¿æ¢ä¸º----
                let converted = line.replace(/\t/g, '----');
                results.push(converted);
            });
            
            if (results.length === 0) {
                document.getElementById('output3').innerText = 'æ ¼å¼ä¸æ­£ç¡®æˆ–æ²¡æœ‰æœ‰æ•ˆæ•°æ®';
                return;
            }
            
            // æ¯è¡Œä¹‹é—´ç©ºä¸€è¡Œï¼ˆä¸¤ä¸ªæ¢è¡Œç¬¦ï¼‰ï¼Œæœ€åç©ºä¸€è¡Œå¹¶æ˜¾ç¤ºæ•°é‡
            let outputText = results.join('\n\n') + '\n\næ•°é‡ï¼š' + results.length + 'ä¸ª';
            document.getElementById('output3').innerText = outputText;
            animateOutput('output3');
        }

        function copyResult3() {
            let text = document.getElementById('output3').innerText.trim();
            if (!text || text === 'è¯·è¾“å…¥å†…å®¹') {
                return;
            }
            
            let temp = document.createElement('textarea');
            temp.value = text;
            temp.style.position = 'fixed';
            temp.style.opacity = '0';
            document.body.appendChild(temp);
            temp.select();
            
            try {
                document.execCommand('copy');
            } catch (err) {
                // é™é»˜å¤±è´¥
            }
            
            document.body.removeChild(temp);
        }
        
        // æ–‡ä»¶æ‹–æ‹½åŠŸèƒ½
        (function() {
            const dropZone = document.getElementById('dropZone');
            const input2 = document.getElementById('input2');
            
            // æ‹–æ‹½åŒºåŸŸæ ·å¼
            function setDropZoneStyle(isDragging) {
                if (isDragging) {
                    dropZone.style.borderColor = 'rgba(79, 172, 254, 0.6)';
                    dropZone.style.background = 'rgba(79, 172, 254, 0.1)';
                    dropZone.style.transform = 'scale(1.02)';
                } else {
                    dropZone.style.borderColor = 'rgba(79, 172, 254, 0.3)';
                    dropZone.style.background = 'rgba(79, 172, 254, 0.05)';
                    dropZone.style.transform = 'scale(1)';
                }
            }
            
            // é˜»æ­¢é»˜è®¤è¡Œä¸º
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            // æ‹–æ‹½è¿›å…¥
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => setDropZoneStyle(true), false);
            });
            
            // æ‹–æ‹½ç¦»å¼€
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => setDropZoneStyle(false), false);
            });
            
            // æ–‡ä»¶æ‹–æ”¾
            dropZone.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            }
            
            // å¤„ç†æ–‡ä»¶
            function handleFile(file) {
                const fileName = file.name.toLowerCase();
                const fileExtension = fileName.split('.').pop();
                
                if (fileExtension === 'txt') {
                    // è¯»å–TXTæ–‡ä»¶
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const content = e.target.result;
                            // æ¸…ç©ºåŸæœ‰å†…å®¹ï¼Œæ›¿æ¢ä¸ºæ–°å†…å®¹
                            input2.value = content;
                            // è‡ªåŠ¨è§¦å‘è½¬æ¢
                            convertFormat();
                        } catch (err) {
                            alert('æ–‡ä»¶è¯»å–å¤±è´¥');
                        }
                    };
                    reader.onerror = function() {
                        alert('æ–‡ä»¶è¯»å–å¤±è´¥');
                    };
                    reader.readAsText(file, 'UTF-8');
                } else if (fileExtension === 'xlsx' || fileExtension === 'xls') {
                    // è¯»å–Excelæ–‡ä»¶
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, {type: 'array'});
                            
                            // è¯»å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
                            const firstSheetName = workbook.SheetNames[0];
                            const worksheet = workbook.Sheets[firstSheetName];
                            
                            // è½¬æ¢ä¸ºJSONï¼Œç„¶åè½¬æ¢ä¸ºTabåˆ†éš”çš„æ–‡æœ¬æ ¼å¼
                            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1, defval: ''});
                            
                            // è½¬æ¢ä¸ºTabåˆ†éš”çš„æ–‡æœ¬ï¼ˆæ¨¡æ‹ŸExcelå¤åˆ¶ç²˜è´´çš„æ ¼å¼ï¼‰
                            // è·³è¿‡ç¬¬ä¸€è¡Œï¼ˆè¡¨å¤´ï¼‰
                            let textContent = '';
                            for (let i = 1; i < jsonData.length; i++) {
                                const row = jsonData[i];
                                if (row && row.length > 0) {
                                    textContent += row.join('\t') + '\n';
                                }
                            }
                            
                            // æ¸…ç©ºåŸæœ‰å†…å®¹ï¼Œæ›¿æ¢ä¸ºæ–°å†…å®¹
                            input2.value = textContent.trim();
                            // è‡ªåŠ¨è§¦å‘è½¬æ¢
                            convertFormat();
                        } catch (err) {
                            alert('æ–‡ä»¶æ ¼å¼é”™è¯¯');
                        }
                    };
                    reader.onerror = function() {
                        alert('æ–‡ä»¶è¯»å–å¤±è´¥');
                    };
                    reader.readAsArrayBuffer(file);
                } else {
                    alert('æ–‡ä»¶æ ¼å¼é”™è¯¯');
                }
            }
        })();
    </script>
</body>
</html>
